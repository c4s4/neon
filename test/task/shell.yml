doc: Built file to test tasks
default: task_$

properties:
  BUILD_DIR: '../../build'

targets:

  task_$:
    doc: Test task $
    steps:
    - if: '_OS != "windows"'
      then:
      # test shell
      - $:  'echo "TEST"'
        1=: 'result'
      - |
        if result != "TEST" {
          throw("$ test failure")
        } else {
          println("$ test success")
        }
      # test command
      - $:  ['echo', 'TEST']
        1=: 'result'
      - |
        if result != "TEST" {
          throw("$ test failure")
        } else {
          println("$ test success")
        }
      # test shell with property
      - 'message = "foo"'
      - $:  'echo "={message}"'
        1=: 'result'
      - |
        if result != "foo" {
          throw("$ test failure")
        } else {
          println("$ test success")
        }
      # test command with property
      - 'message = "foo"'
      - $:  ['echo', '={message}']
        1=: 'result'
      - |
        if result != "foo" {
          throw("$ test failure")
        } else {
          println("$ test success")
        }
      - for: 'i'
        in:  'range(3)'
        do:
        - $:  ['echo', '={i}']
          1=: 'result'
        - print: '={i}'
        - assert: 'result == toString(i)'
